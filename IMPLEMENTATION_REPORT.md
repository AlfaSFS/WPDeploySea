# üéØ –û—Ç—á–µ—Ç –æ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ WayForPay –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–Ω—ã–µ –∑–∞–¥–∞—á–∏

### 1. –ü–æ–¥–¥–µ—Ä–∂–∫–∞ items –≤ API ‚úÖ

-  **–§–∞–π–ª**: `backend/src/index.js`
-  **–§—É–Ω–∫—Ü–∏—è**: –†–∞—Å—à–∏—Ä–µ–Ω —ç–Ω–¥–ø–æ–∏–Ω—Ç `/api/orders`
-  **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–æ–≤–æ–≥–æ —Ñ–æ—Ä–º–∞—Ç–∞ —Å `items` + –æ–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å

### 2. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ WayForPay –∫–ª–∞—Å—Å–∞ ‚úÖ

-  **–§–∞–π–ª**: `backend/src/payments/wayforpay.js`
-  **–§—É–Ω–∫—Ü–∏—è**: –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∞—Å—Å–∏–≤–æ–≤ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
-  **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ñ–æ—Ä–º–∞—Ç–∞ (–º–∞—Å—Å–∏–≤/–æ–¥–∏–Ω–æ—á–Ω—ã–π)

### 3. –£–ª—É—á—à–µ–Ω–∏–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è ‚úÖ

-  **–§–∞–π–ª**: `backend/src/index.js` (callback)
-  **–§—É–Ω–∫—Ü–∏—è**: –î–µ—Ç–∞–ª—å–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ callback
-  **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –ó–∞–≥–æ–ª–æ–≤–∫–∏ + —Ç–µ–ª–æ –∑–∞–ø—Ä–æ—Å–∞ + –≤—Ä–µ–º–µ–Ω–Ω–∞—è –º–µ—Ç–∫–∞

### 4. –¢–µ—Å—Ç–æ–≤—ã–µ —Å–∫—Ä–∏–ø—Ç—ã ‚úÖ

-  **–§–∞–π–ª**: `wfp-callback-test.mjs`
-  **–§—É–Ω–∫—Ü–∏—è**: –≠–º—É–ª—è—Ü–∏—è callback –æ—Ç WayForPay
-  **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –£—Å–ø–µ—à–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∏

### 5. –ö–æ–º–ø–ª–µ–∫—Å–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ ‚úÖ

-  **–§–∞–π–ª**: `test-payment-flow.mjs`
-  **–§—É–Ω–∫—Ü–∏—è**: –ü–æ–ª–Ω—ã–π —Ü–∏–∫–ª —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
-  **–†–µ–∑—É–ª—å—Ç–∞—Ç**: –í—Å–µ —Ç–µ—Å—Ç—ã –ø—Ä–æ–π–¥–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ

### 6. –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è ‚úÖ

-  **API_DOCUMENTATION.md**: –ü–æ–ª–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è API
-  **CLOUDFLARE_SETUP.md**: –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ Cloudflare
-  **frontend-example.html**: –ü—Ä–∏–º–µ—Ä —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥–∞

## üß™ –†–µ–∑—É–ª—å—Ç–∞—Ç—ã —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç 1: –ù–æ–≤—ã–π —Ñ–æ—Ä–º–∞—Ç —Å items

```json
{
   "email": "test-new@example.com",
   "amount": 150,
   "currency": "UAH",
   "items": [
      { "name": "CV Writing Service", "price": 80, "count": 1 },
      { "name": "CV Translation", "price": 40, "count": 1 },
      { "name": "Email Distribution", "price": 30, "count": 1 }
   ]
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ –£—Å–ø–µ—à–Ω–æ, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –º–∞—Å—Å–∏–≤—ã –ø—Ä–æ–¥—É–∫—Ç–æ–≤

### –¢–µ—Å—Ç 2: –°—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç (—Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å)

```json
{
   "email": "test-old@example.com",
   "total_amount": 100,
   "currency": "UAH",
   "name": "–¢–µ—Å—Ç",
   "surname": "–°—Ç–∞—Ä—ã–π"
}
```

**–†–µ–∑—É–ª—å—Ç–∞—Ç**: ‚úÖ –£—Å–ø–µ—à–Ω–æ, –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç –æ–¥–∏–Ω–æ—á–Ω—ã–π –ø—Ä–æ–¥—É–∫—Ç

### –¢–µ—Å—Ç 3: Callback

**–°—Ç–∞—Ç—É—Å**: 200 ‚úÖ **–û—Ç–≤–µ—Ç**:
`{"orderReference":"...","status":"accept","time":...,"signature":"..."}`

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

-  **–§–∞–π–ª–æ–≤ –∏–∑–º–µ–Ω–µ–Ω–æ**: 6
-  **–°—Ç—Ä–æ–∫ –∫–æ–¥–∞ –¥–æ–±–∞–≤–ª–µ–Ω–æ**: ~400
-  **–ù–æ–≤—ã—Ö —Ñ–∞–π–ª–æ–≤**: 5
-  **–¢–µ—Å—Ç–æ–≤ –ø—Ä–æ–π–¥–µ–Ω–æ**: 3/3
-  **–í—Ä–µ–º—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏**: ~2 —á–∞—Å–∞

## üöÄ –ì–æ—Ç–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏

### Backend API

-  ‚úÖ `/api/orders` - —Å–æ–∑–¥–∞–Ω–∏–µ –∑–∞–∫–∞–∑–æ–≤ (–Ω–æ–≤—ã–π + —Å—Ç–∞—Ä—ã–π —Ñ–æ—Ä–º–∞—Ç)
-  ‚úÖ `/api/orders/{id}/status` - –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞
-  ‚úÖ `/api/payments/callback` - –æ–±—Ä–∞–±–æ—Ç–∫–∞ callback –æ—Ç WayForPay
-  ‚úÖ `/api/orders/health` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –∑–¥–æ—Ä–æ–≤—å—è API

### WayForPay Integration

-  ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –º–∞—Å—Å–∏–≤–æ–≤ –ø—Ä–æ–¥—É–∫—Ç–æ–≤
-  ‚úÖ –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –ø—Ä–∞–≤–∏–ª—å–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–µ–π
-  ‚úÖ –û–±—Ä–∞–±–æ—Ç–∫–∞ callback —Å –ø—Ä–æ–≤–µ—Ä–∫–æ–π –ø–æ–¥–ø–∏—Å–∏
-  ‚úÖ –¢–µ—Å—Ç–æ–≤—ã–µ —Ä–µ–∫–≤–∏–∑–∏—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

-  ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ç–µ—Å—Ç—ã
-  ‚úÖ –≠–º—É–ª—è—Ü–∏—è callback
-  ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

## ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –≤–Ω–∏–º–∞–Ω–∏—è

### 1. Cloudflare –Ω–∞—Å—Ç—Ä–æ–π–∫–∞

-  **–ü—Ä–æ–±–ª–µ–º–∞**: –û—à–∏–±–∫–∞ 521 –¥–ª—è callback URL
-  **–†–µ—à–µ–Ω–∏–µ**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–∞–≤–∏–ª–∞ bypass (—Å–º. CLOUDFLARE_SETUP.md)
-  **–°—Ç–∞—Ç—É—Å**: ‚ö†Ô∏è –¢—Ä–µ–±—É–µ—Ç –Ω–∞—Å—Ç—Ä–æ–π–∫–∏

### 2. –î–æ–º–µ–Ω –¥–ª—è callback

-  **–¢–µ–∫—É—â–∏–π**: `https://seafarer-cv.com/api/payments/callback`
-  **–†–∞–±–æ—á–∏–π**: `http://91.107.204.141/api/payments/callback`
-  **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø–æ–¥–¥–æ–º–µ–Ω –∏–ª–∏ Cloudflare

## üìã –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### –í—ã—Å–æ–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

1. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å Cloudflare** –ø—Ä–∞–≤–∏–ª–∞ –¥–ª—è callback
2. **–ü—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å —Ä–µ–∞–ª—å–Ω—ã–µ –ø–ª–∞—Ç–µ–∂–∏** —Å —Ç–µ—Å—Ç–æ–≤—ã–º–∏ –∫–∞—Ä—Ç–∞–º–∏
3. **–û–±–Ω–æ–≤–∏—Ç—å —Ñ—Ä–æ–Ω—Ç–µ–Ω–¥** –ø—Ä–æ–µ–∫—Ç–∞

### –°—Ä–µ–¥–Ω–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

1. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥** –ª–æ–≥–æ–≤ callback
2. **–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è** –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏
3. **–î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ç–µ—Å—Ç—ã**

### –ù–∏–∑–∫–∏–π –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç

1. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è** –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
2. **–ê–Ω–∞–ª–∏—Ç–∏–∫–∞** –ø–ª–∞—Ç–µ–∂–µ–π
3. **–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è** –ø–æ email

## üéâ –ó–∞–∫–ª—é—á–µ–Ω–∏–µ

**WayForPay –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —É—Å–ø–µ—à–Ω–æ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –∏ –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é!**

-  ‚úÖ –í—Å–µ –æ—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ —Ä–∞–±–æ—Ç–∞—é—Ç
-  ‚úÖ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–æ–π–¥–µ–Ω–æ
-  ‚úÖ –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è —Å–æ–∑–¥–∞–Ω–∞
-  ‚úÖ –û–±—Ä–∞—Ç–Ω–∞—è —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∞

**–°–∏—Å—Ç–µ–º–∞ –≥–æ—Ç–æ–≤–∞ –¥–ª—è –ø—Ä–∏–µ–º–∞ —Ç–µ—Å—Ç–æ–≤—ã—Ö –ø–ª–∞—Ç–µ–∂–µ–π —á–µ—Ä–µ–∑ WayForPay!** üöÄ
